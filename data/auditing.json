[
  {
    "bookmarklet": "WTFocus",
    "description": "Display information with focusable elements",
    "file": "wtfocus.js",
    "pageTest": "self",
    "source": "Ian Lloyd",
    "sourceUrl": "https://a11y-tools.com/bookmarklets/",
    "auditing": true,
    "tags": [
      "2.4.4 Link Purpose (In Context) (A)",
      "4.1.2 Name, Role, Value (A)"
    ],
    "dist": "javascript:void%20(()=%3E%7B(function()%7B%22use%20strict%22;function%20re()%7Blet%20z=document.activeElement,H=document.querySelectorAll('a%5Bhref%5D,button,select,input:not(%5Btype=%22hidden%22%5D),textarea,summary,area,%5Btabindex%5D:not(#WTFocusPanel):not(%5Btabindex%5E=%22-1%22%5D),%5Bcontenteditable%5D:not(%5Bcontenteditable=%22false%22%5D)'),E=%22background:#fff;color:darkgreen;font-weight:bold;text-decoration:line-through%22,j=%22font-weight:bold;color:#99f170;background:#333;display:inline-block;padding:3px;%22,h=%22color:pink;background:#333;padding:3px;%22,A=%22color:black;background:#fefbe3;font-weight:bold;%22,a=document.createElement(%22div%22),O=document.createElement(%22div%22),R=20,Y=400,w=7,ie='%3Cspan%20aria-hidden=%22true%22%3E%5Cu%7B1F449%7D%5Cu%7B1F3FD%7D%3C/span%3E%3Cspan%20class=%22visually-hidden%22%3EAccessible%20name%20provided%20by%3C/span%3E%20',ce='%3Cspan%20aria-hidden=%22true%22%3E%5Cu%7B1F6A8%7D%3C/span%3E%20%3Cspan%20class=%22visually-hidden%22%3EWarning%3C/span%3E',V,P=%22Accessible%20name:%20%22,k=!1,p=%22%22,m=!1,x=!1,I=!1,G=!1,L=!1;function%20W()%7Bm=!1,x=!1%7Dfunction%20l(e,r,o,n,C)%7Bk&&(r=r.split(%22%3C%22).join(%22&lt;%22).split(%22%3E%22).join(%22&gt;%22),p+=%22%3Cli%22,(C%7C%7Cn)&&(p+='%20class=%22',C&&(p+=%22visible%22),n&&(p+=%22outline%22),p+='%22'),p+='%20role=%22listitem%22%3E%3Cspan%20style=%22'+o+'%22%3E',m&&(p+=ie),x&&(p+=ce),p+=e+%22%3C/span%3E&nbsp;%22+r+%60%3C/li%3E%0A%60),r=r.replace(%22&lt;%22,%22%3C%22).replace(%22&gt;%22,%22%3E%22),console.log(%22%25c%22+e+'%22'+r+'%22',o)%7Dfunction%20J()%7Blet%20e=document.createElement(%22button%22);e.textContent=%22Close%20(Esc)%22,e.setAttribute(%22type%22,%22button%22),e.setAttribute(%22class%22,%22panel-btn%22),e.addEventListener(%22click%22,()=%3E%7BD()%7D);let%20r=document.createElement(%22button%22);r.textContent=%22Change%20Mode%20(M)%22,r.setAttribute(%22type%22,%22button%22),r.setAttribute(%22class%22,%22panel-btn%22),r.addEventListener(%22click%22,o=%3E%7BK()%7D),a.appendChild(e),a.appendChild(r)%7Dfunction%20K()%7BL?(document.querySelector(%22#WTFocusPanel%22).classList.remove(%22curtainsMode%22),document.querySelector(%22#WTFocusPanel%22).removeAttribute(%22style%22),document.querySelector(%22#WTFocusCurtain%22).setAttribute(%22hidden%22,%22hidden%22),L=!1,P=%22Accessible%20name:%20%22):(document.querySelector(%22#WTFocusPanel%22).classList.add(%22curtainsMode%22),document.querySelector(%22#WTFocusCurtain%22).removeAttribute(%22hidden%22),L=!0,P=%22%22),Q(z),z.focus()%7Dfunction%20D()%7Bdocument.querySelector(%22#WTFocusCurtain%22).remove(),document.querySelector(%22#WTFocusPanel%22).remove(),document.querySelector(%22#panelStyles%22).remove(),document.querySelector(%22#focusStyles%22).remove()%7Dfunction%20Q(e)%7Blet%20r=e.getBoundingClientRect(),o=document.documentElement.scrollTop,n=r.right+R+Y,C=a.offsetHeight,q=o+r.top+C,i=window.innerWidth,c=window.innerHeight;L?document.querySelector(%22#WTFocusPanel%22).removeAttribute(%22style%22):n%3Ei?(q%3Ec?(a.style.top=%22auto%22,a.style.bottom=c-(o+r.bottom)-10+%22px%22,a.classList.add(%22toBottom%22)):(a.style.top=o+r.top+%22px%22,a.style.bottom=%22auto%22,a.classList.remove(%22toBottom%22)),a.style.left=%22auto%22,a.style.right=i-r.left+R-w+%22px%22,a.classList.add(%22toLeft%22)):(q%3Ec?(a.style.top=%22auto%22,a.style.bottom=c-(o+r.bottom)-10+%22px%22,a.classList.add(%22toBottom%22)):(a.style.top=o+r.top+%22px%22,a.style.bottom=%22auto%22,a.classList.remove(%22toBottom%22)),a.style.left=r.right+R-w+%22px%22,a.style.right=%22auto%22,a.classList.remove(%22toLeft%22))%7Dconsole.clear(),function()%7Blet%20e=document.createElement(%22style%22);e.setAttribute(%22type%22,%22text/css%22),e.setAttribute(%22id%22,%22panelStyles%22),e.textContent=%22.dupeAccName%20%7Boutline:4px%20dashed%20#CC3300!important;outline-offset:%22+w+%22px!important;overflow:visible;%7D%20.WTFocusTempFocusStyle:focus%20%7Boutline:%22+w+%22px%20solid%20black!important;outline-offset:%22+w+%22px!important;overflow:visible;/*background:yellow!important;color:black!important;*/%7D%20.WTFocusTempFocusStyle.dupeAccName:focus%20%7Boutline-color:#CC3300!important;%7D%20.visually-hidden%20%7Bclip-path:%20inset(100%25);clip:%20rect(1px,%201px,%201px,%201px);height:%201px;overflow:%20hidden;position:%20absolute;white-space:%20nowrap;width:%201px;%7D#WTFocusCurtain%20%7Bbackground:black;position:%20fixed;top:%200;bottom:%200;left:%200;right:%200;z-index:49999%7D%22,document.querySelector(%22body%22).appendChild(e)%7D(),document.querySelector(%22#WTFocusCurtain%22)&&D(),k=!0,p=%22%22,function(e)%7Blet%20r=document.createElement(%22style%22);r.setAttribute(%22type%22,%22text/css%22),r.setAttribute(%22id%22,%22focusStyles%22),r.textContent=%22#WTFocusPanel.error%20%7Bbackground:darkred;%7D%20#WTFocusPanel.warning%20%7Bbackground:#CC3300;%7D%20#WTFocusPanel.curtainsMode.error%20%7Bbackground:black;%7D%20#WTFocusPanel.curtainsMode%20%7Bz-index:50000;position:fixed;top:50%25;left:50%25;transform:translate(-50%25,-50%25);%7D%20#WTFocusPanel.curtainsMode.warning%20%7Bbackground:black;%7D%20#WTFocusPanel%5Bhidden%5D%20%7Bdisplay:none;%7D%20#WTFocusPanel%20*%20%7Btext-align:left%7D%20#WTFocusPanel%20%7Bborder:2px%20solid%20#fff;z-index:1000;text-shadow:none;font-family:sans-serif;display:block;text-align:left;position:%20absolute;z-index:10000;background:%20black;padding:%2020px%2020px;width:%22+e+%22px;font-size:16px;%7D%20#WTFocusPanel%20button%20%7Bfont-weight:bold;background:none;color:#fff;padding:3px%2010px;font-size:14px;border:1px%20solid%20#fff;display:inline-block;margin:10px%201em%20-10px%200;%7D%20#WTFocusPanel%20ul,#WTFocusPanel%20li%20%7Bmargin:0;padding:0;list-style:none%7D%20#WTFocusPanel%20li%20%7Bmargin:3px%200;background:#fff;color:#333;padding:2px%7D%20#WTFocusPanel%20li.outline%20%7Boutline:4px%20solid%20rgb(58,%20190,%2058);outline-offset:-4px;padding:8px%7D%20#WTFocusPanel.error:before%20%7Bbackground:darkred%7D%20#WTFocusPanel.warning:before%20%7Bbackground:#CC3300%7D%20#WTFocusPanel:before%20%7Bcontent:'';display:block;height:20px;width:20px;transform:rotate(45deg);position:absolute;background:#000;left:-12px;top:3px;border:2px%20solid%20#fff;border-right:none;border-top:none;%7D%20#WTFocusPanel.toBottom:before%20%7Btop:auto;bottom:3px%7D%20#WTFocusPanel.toLeft:before%20%7Bleft:auto;right:-12px;border:2px%20solid%20#fff;border-left:none;border-bottom:none;%7D%20#WTFocusPanel.curtainsMode%20%7Boutline:10px%20solid%20orange;%7D%20#WTFocusPanel.curtainsMode:before%20%7Bdisplay:none;%7D%20#WTFocusPanel.curtainsMode%20li%20%7Bdisplay:none;%7D%20#WTFocusPanel.curtainsMode%20li.visible%20%7Bdisplay:block;%7D%20#WTFocusPanel.curtainsMode%20li%20span%20%7Bdisplay:none!important;%7D%20%22,document.querySelector(%22head%22).appendChild(r)%7D(Y),O.setAttribute(%22id%22,%22WTFocusCurtain%22),O.setAttribute(%22hidden%22,%22hidden%22),document.querySelector(%22body%22).appendChild(O),a.setAttribute(%22id%22,%22WTFocusPanel%22),L&&a.setAttribute(%22class%22,%22curtainsMode%22),a.setAttribute(%22aria-live%22,%22polite%22),a.setAttribute(%22tabindex%22,%22-1%22),a.setAttribute(%22hidden%22,%22hidden%22),a.setAttribute(%22role%22,%22region%22),a.setAttribute(%22aria-label%22,%22Accessibility%20properties%20panel%22),document.querySelector(%22body%22).appendChild(a),window.addEventListener(%22keyup%22,e=%3E%7Be.key===%22Escape%22&&document.querySelector(%22#WTFocusPanel%22)&&D()%7D),window.addEventListener(%22keyup%22,e=%3E%7Be.key.toLowerCase()===%22m%22&&document.querySelector(%22#WTFocusPanel%22)&&K()%7D),J();let%20U=%5B%5D;Array.from(H).forEach(function(e)%7Be.classList.add(%22WTFocusTempFocusStyle%22);let%20r=e.querySelectorAll(%22style%22);Array.from(r).forEach(function(o)%7Bo.remove()%7D),e.addEventListener(%22focus%22,()=%3E%7Blet%20o=e.getAttribute(%22role%22),n=e.tagName.toLowerCase();if(console.clear(),!o)%7Bif(n!=%22article%22&&n!=%22button%22&&n!=%22dialog%22&&n!=%22figure%22&&n!=%22img%22&&n!=%22main%22&&n!=%22math%22%7C%7C(o=n),n==%22summary%22&&(o=%22button%22),n==%22aside%22&&(o=%22complementary%22),n==%22dd%22&&(o=%22definition%22),n==%22html%22&&(o=%22document%22),n!=%22details%22&&n!=%22fieldset%22&&n!=%22optgroup%22%7C%7C(o=%22group%22),n!=%22menu%22&&n!=%22ol%22&&n!=%22ul%22%7C%7C(o=%22list%22),n==%22datalist%22&&(o=%22listbox%22),n==%22li%22&&(o=%22listitem%22),n==%22nav%22&&(o=%22navigation%22),n==%22progress%22&&(o=%22progressbar%22),n==%22hr%22&&(o=%22separator%22),n==%22output%22&&(o=%22status%22),n!=%22dfn%22&&n!=%22dt%22%7C%7C(o=%22term%22),n==%22a%22&&(o=%22link%22),n==%22select%22&&(o=%22listbox%22),n==%22textarea%22&&(o=%22textbox%22),n==%22input%22)%7Blet%20t=e.getAttribute(%22type%22).toLowerCase();t===%22text%22&&(o=%22textbox%22),t===%22range%22&&(o=%22slider%22),t===%22number%22&&(o=%22spinbutton%22),t!==%22checkbox%22&&t!==%22radio%22%7C%7C(o=t),t!==%22button%22&&t!==%22image%22&&t!==%22reset%22&&t!==%22submit%22%7C%7C(o=%22button%22)%7D%7Dz=e,Array.from(H).forEach(function(t)%7Bt.classList.remove(%22dupeAccName%22)%7D);let%20C=!1;m=!1,x=!1;let%20q=e.querySelectorAll(%22img,%20%5Brole='image'%5D%5Baria-label%5D,%20%5Brole='img'%5D%5Baria-label%5D%22);(C=q.length%3E0)&&Array.from(q).forEach(function(t)%7Blet%20d=document.createElement(%22SPAN%22);var%20T,B;d.setAttribute(%22class%22,%22visually-hidden%22),d.setAttribute(%22style%22,%22clip-path:%20inset(100%25);clip:%20rect(1px,%201px,%201px,%201px);height:%201px;overflow:%20hidden;position:%20absolute;white-space:%20nowrap;width:%201px;%22),d.setAttribute(%22data-temp-node%22,%22true%22),t.getAttribute(%22alt%22)&&(d.textContent=%22%20%22+t.getAttribute(%22alt%22)+%22%20%22),t.getAttribute(%22role%22)&&t.getAttribute(%22aria-label%22)&&(d.textContent=%22%20%22+t.getAttribute(%22aria-label%22)+%22%20%22),T=d,(B=t).parentNode.insertBefore(T,B.nextSibling)%7D),setTimeout(function()%7Be.classList.add(%22WTFocusTempFocusStyle%22)%7D,100),p=%22%22;let%20i=e.tagName.toLowerCase(),c=e.getAttribute(%22role%22);c&&(c=e.getAttribute(%22role%22).toLowerCase());let%20Z=%22%3C%22+i+%22%3E%22,_=!1,$=!1;c&&(Z=%22%3C%22+i+'%20role=%22'+c+'%22%3E',(c===%22link%22&&i===%22a%22%7C%7Cc===%22button%22&&i===%22button%22%7C%7Cc===%22image%22&&i===%22img%22%7C%7Cc===%22img%22&&i===%22img%22%7C%7Cc===%22navigation%22&&i===%22nav%22%7C%7Cc===%22heading%22&&(i===%22h1%22%7C%7Ci===%22h2%22%7C%7Ci===%22h3%22%7C%7Ci===%22h4%22%7C%7Ci===%22h5%22%7C%7Ci===%22h6%22))&&(_=!0),(c===%22link%22&&i!==%22a%22%7C%7Cc===%22button%22&&i!==%22button%22%7C%7C(c===%22image%22%7C%7Cc===%22image%22)&&i!==%22img%22%7C%7Cc===%22navigation%22&&i!==%22nav%22%7C%7Cc===%22heading%22&&i!==%22h1%22&&i!==%22h2%22&&i!==%22h3%22&&i!==%22h4%22&&i!==%22h5%22&&i!==%22h6%22)&&($=!0));let%20ee,b=e.textContent,f=e.ariaLabel,S=e.getAttribute(%22aria-labelledby%22),N=e.getAttribute(%22placeholder%22),F=%22%22,g=e.getAttribute(%22value%22),v=e.getAttribute(%22title%22),s=%22%22,y=%22%22,te=!1,oe=!1,u=%22%22,ne=!1;k&&Q(e),b=b.trim();let%20ae=function(t,d)%7Bfor(;(t=t.parentElement)&&!(t.matches%7C%7Ct.matchesSelector).call(t,d););return%20t%7D(e,%22label%22);if(ae&&(te=!0,s=y=ae.textContent.trim()),e.getAttribute(%22id%22))%7Blet%20t=document.querySelector(%22%5Bfor='%22+e.getAttribute(%22id%22)+%22'%5D%22);t&&(oe=!0,y=t.textContent)%7Dif(te%7C%7Coe%7C%7C(y=%22N/A%22),b%7C%7C(b=%22N/A%22),g%7C%7C(g=%22N/A%22),v%7C%7C(v=%22N/A%22),N%7C%7C(N=%22N/A%22),f%7C%7C(f=%22N/A%22),S)%7Blet%20t=(ee=S).split(%22%20%22);t.length%3E1?(Array.from(t).forEach(function(d)%7Bdocument.querySelector(%22#%22+d)?F+=document.querySelector(%22#%22+d).textContent+%22%20%22:F+=%22%5Cu2753%5Cu2753%5Cu2753%20%22%7D),F=F.trim()):F=document.querySelector(%22#%22+ee).textContent%7Delse%20S=%22N/A%22;let%20le=e.querySelectorAll(%22%5Baria-hidden='true'%5D,%5Brole='presentation'%5D%22),M=b;if(le.length%3E0&&(ne=!0,Array.from(le).forEach(function(t)%7Blet%20d=t.textContent;d!==%22%22&&(M=M.split(d).join(%22%20%22))%7D),M=M.trim()),i===%22input%22)%7Blet%20t=e.getAttribute(%22type%22);t===%22submit%22&&g===%22N/A%22&&(s=%22Submit%22,u=%22Not%20provided%20(using%20default)%22),t===%22image%22&&g===%22N/A%22&&(s=%22Submit%22,u=%22Not%20provided%20(using%20default)%22),t===%22cancel%22&&g===%22N/A%22&&(s=%22Cancel%22,u=%22Not%20provided%20(using%20default)%22)%7Dif(v!==%22N/A%22&&(s=v,u=%22title%20attribute%22),g!==%22N/A%22&&(s=g,u=%22value%20attribute%22),N!==%22N/A%22&&(s=N,u=%22placeholder%20attribute%22),b!==%22N/A%22&&(s=M,u=%22Inner%20text%20content%22),y!==%22N/A%22&&(s=y,u=%22%3Clabel%3E%20text%22),f!==%22N/A%22&&(s=f,u=%22aria-label%22),S!==%22N/A%22&&(s=F,u=%22aria-labelledby%22),console.log(%22%25cACTIVE%20ELEMENT:%20%22,%22background:#193c10;color:white;%22),console.log(e),I=e.getAttribute(%22data-dupe%22)===%22true%22,G=I&&s===%22%22,s===%22%22%7C%7CI)%7Bif(s===%22%22&&(x=!0,k&&a.classList.add(%22error%22),l(P+%22No%20accessible%20name!%22,%22%22,h),l(%22Accessible%20Name%20Source:%20N/A%22,%22%22,h)),I&&s!==%22%22)%7Bk&&a.classList.add(%22warning%22);let%20t=document.querySelectorAll(%22%5Bdata-accname='%22+s+%22'%5D%22),d=t.length;l(P,s,h,!1,!0),G%7C%7C(Array.from(t).forEach(function(T)%7BT.classList.add(%22dupeAccName%22)%7D),l(%22Duplicate%20warning!%22,d+%22%20elements%20on%20page%20have%20the%20same%20accessible%20name%22,h)),console.log(%22Elements%20on%20page%20that%20have%20identical%20accessible%20names:%22),Array.from(t).forEach(function(T)%7Bconsole.log(T)%7D),l(%22Accessible%20Name%20Source:%20%22,u,h)%7D%7Delse%20k&&(a.classList.remove(%22error%22),a.classList.remove(%22warning%22)),l(P,s,j,!1,!0),l(%22Accessible%20Name%20Source:%20%22,u,j);x=!1,l(%22HTML%20Element:%20%22,Z,j),l(%22Role:%20%22,o,%22color:#333;background:#fff;%22,!1,!0),k%7C%7Cconsole.log(%22%25cACCESSIBLE%20NAME%20COMES%20FROM:%20%22,%22background:#193c10;color:white;%22),_&&(x=!0,l(%22Superfluous%20%60role%60%20attribute%22,%22%22,h)),$&&(x=!0,l(%22Better%20to%20use%20a%20native%20HTML%20element%22,%22%22,h)),b=b.trim(),y=y.trim(),v=v.trim(),f=f.trim(),S=S.trim(),W(),u===%22placeholder%20attribute%22?(m=!0,l(%22@placeholder:%20%22,N,A,!0)):l(%22@placeholder:%20%22,N,N===%22N/A%22?%22color:#333;background:#fff;%22:E),W(),u===%22title%20attribute%22?(m=!0,l(%22@title:%20%22,v,A,!0)):l(%22@title:%20%22,v,v===%22N/A%22?%22color:#333;background:#fff;%22:E),W(),u===%22value%20attribute%22?(m=!0,l(%22@value:%20%22,g,A,!0)):l(%22@value:%20%22,g,g===%22N/A%22?%22color:#333;background:#fff;%22:E),W(),u===%22Inner%20text%20content%22?(m=!0,l(C?%22Inner%20text%20content%20(includes%20image%20alt):%20%22:%22Inner%20text%20content:%20%22,b,A,!0),ne&&l(%22!%20elements%20hidden%20to%20AT%20removed%22,%22%22,A)):l(%22Text%20Content:%20%22,b,b===%22N/A%22?%22color:#333;background:#fff;%22:E),W(),u===%22%3Clabel%3E%20text%22?(m=!0,l(%22Visible%20%60label%60%20text:%20%22,y,A,!0)):l(%22Visible%20%60label%60%20text:%20%22,y,y===%22N/A%22?%22color:#333;background:#fff;%22:E),W(),u===%22aria-label%22?f===b?(x=!0,l(%22%60aria-label%60%20content%20is%20same%20as%20inner%20text%20content%22,%22%22,h)):(m=!0,l(%22@aria-label%20value:%20%22,f,A,!0)):l(%22@aria-label%20value:%20%22,f,f===%22N/A%22?%22color:#333;background:#fff;%22:E),W(),u===%22aria-labelledby%22?F===b?(x=!0,l(%22%60aria-labelledby%60%20source%20content%20is%20same%20as%20inner%20text%20content%22,%22%22,h)):(m=!0,l(%22@aria-labelledby%20value:%20%22,S,A,!0),l(%22@aria-labelledby%20sources:%20%22,F,A)):(l(%22@aria-labelledby%20value:%20%22,S,%22color:#333;background:#fff;%22),l(%22@aria-labelledby%20sources:%20%22,%22N/A%22,%22color:#333;background:#fff;%22)),k&&(document.querySelector(%22#WTFocusPanel%22).innerHTML='%3Cul%20role=%22list%22%3E'+p+%22%3C/ul%3E%22,document.querySelector(%22#WTFocusPanel%22).removeAttribute(%22hidden%22),J());let%20se=document.querySelectorAll(%22%5Bdata-temp-node%5D%22);Array.from(se).forEach(function(t)%7Bt.remove()%7D),e.setAttribute(%22data-accname%22,s),X%7C%7Cfunction(t,d)%7Blet%20T=!1;Array.from(U).forEach(function(B)%7BB===t&&(T=!0)%7D),T?(d.setAttribute(%22data-dupe%22,%22true%22),document.querySelector(%22%5Bdata-accname='%22+t+%22'%5D%22).setAttribute(%22data-dupe%22,%22true%22)):U.push(t)%7D(s,e)%7D)%7D);let%20X=!1;(function()%7Bif(V=document.activeElement,Array.from(H).forEach(function(e)%7Bdocument.activeElement===e&&e.blur(),e.focus()%7D),X=!0,V.tagName===%22BODY%22)%7Blet%20e=document.querySelector(%22body%22);e.setAttribute(%22tabindex%22,%22-1%22),e.focus(),document.querySelector(%22#WTFocusPanel%22).setAttribute(%22hidden%22,%22hidden%22)%7Delse%20V.focus();console.clear()%7D)(),console.log(%22had%20focus%20=%20%22,z)%7Dre()%7D)();%7D)();%0A"
  }
]